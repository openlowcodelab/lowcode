@inherits LayoutComponentBase

<AntDesign.ProLayout.BasicLayout Logo="@("logo.png")" Title="@AppId" MenuData="_menuData">
    <RightContentRender>
        @*<AntDesign.Pro.Template.Components.RightContent />*@
        RightContent
    </RightContentRender>
    <ChildContent>
        @Body
    </ChildContent>
    <FooterRender>
        <FooterView Copyright="2021 H.LowCode" Links="Links"></FooterView>
    </FooterRender>
</AntDesign.ProLayout.BasicLayout>
<SettingDrawer />

@code
{
    [Parameter]
    public string AppId { get; set; }

    private MenuDataItem[] _menuData;

    protected override void OnInitialized()
    {
        base.OnInitialized();

        Init();
    }

    private void Init()
    {
        InitAppId();

        InitMenuData(AppId);
    }

    private void InitAppId()
    {
        if ((this.Body.Target as RouteView)?.RouteData.RouteValues?.TryGetValue("AppId", out object appId) == true)
        {
            AppId = appId?.ToString();
        }

        if (string.IsNullOrEmpty(AppId))
            throw new NullReferenceException(nameof(AppId));
    }

    private void InitMenuData(string appId)
    {
        _menuData = [
            new MenuDataItem
            {
                Path = $"/{appId}/index",
                Name = "首页",
                Key = "home"
            },
            new MenuDataItem
            {
                Path = $"/{appId}/1",
                Name = "基础表单",
                Key = "basicform"
            },
            new MenuDataItem
            {
                Path = $"/{appId}/2",
                Name = "联动表单",
                Key = "linkageform"
            },
            new MenuDataItem
            {
                Path = $"/{appId}/3",
                Name = "个性化表单",
                Key = "customform"
            },
            new MenuDataItem
            {
                Path = $"/{appId}/4",
                Name = "检验表单",
                Key = "validateform"
            },
            new MenuDataItem
            {
                Path = $"/{appId}/5",
                Name = "复杂表单",
                Key = "complexform"
            },
            new MenuDataItem
            {
                Path = $"/{appId}/6",
                Name = "列表",
                Key = "table"
            }
        ];
    }

    public LinkItem[] Links { get; set; } =
    {
        new LinkItem
        {
            Key = "H.LowCode",
            Title = "H.LowCode",
            Href = "/",
            BlankTarget = true,
        }
    };
}