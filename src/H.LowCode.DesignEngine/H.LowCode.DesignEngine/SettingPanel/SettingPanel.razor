<Tabs DefaultActiveKey="tab_page" @bind-ActiveKey="@ActiveTabKey" Class="designpage" Style="width:250px; padding:0px 8px;">
    @if (ShowPropertyPanel)
    {
        <TabPane Key="tab_property" Tab="属性">
            <PropertySetting ComponentSchema="@ComponentSchema"></PropertySetting>
        </TabPane>
        <TabPane Key="tab_style" Tab="样式">
            <StyleSetting ComponentSchema="@ComponentSchema"></StyleSetting>
        </TabPane>
        <TabPane Key="tab_action" Tab="动作">
            <ActionSetting ComponentSchema="@ComponentSchema"></ActionSetting>
        </TabPane>
    }
    <TabPane Key="tab_page" Tab="页面">
        <PageSetting PagePropertySchema="pagePropertySchema"></PageSetting>
    </TabPane>
</Tabs>

@code {
    public bool ShowPropertyPanel { get; set; }

    public ComponentSchema ComponentSchema { get; set; }

    private string ActiveTabKey { get; set; } = "tab_page";

    private PageSettingSchema pagePropertySchema = new PageSettingSchema();

    protected override void OnInitialized()
    {
        RegisterEventDispatcher();
        base.OnInitialized();
    }

    private void RegisterEventDispatcher()
    {
        //订阅设计面板中的组件点击事件
        BlazorEventDispatcher.RegisterEvent("designerengine.dropitem.onclick", (value) =>
        {
            ComponentSchema = (ComponentSchema)value;
            ShowPropertyPanel = true;
            ActiveTabKey = "tab_property";
            StateHasChanged();
        });

        //订阅设计面板取消选中事件
        BlazorEventDispatcher.RegisterEvent("designerengine.dropitem.onblur", (value) =>
        {
            ComponentSchema = null;
            ShowPropertyPanel = false;
            ActiveTabKey = "tab_page";
            StateHasChanged();
        });
    }
}
